<tool id="mudirac" name="MuDirac" version="@TOOL_VERSION@+galaxy@WRAPPER_VERSION@" python_template_version="3.5" profile="23.0" license="MIT">
    <description> Muonic atom Dirac equation solver </description>
    <macros>
        <token name="@TOOL_VERSION@">1.0.1</token>
        <token name="@WRAPPER_VERSION@">0</token>
    </macros>
    <creator>
        <person givenName="Subindev" familyName="Devadasan" url="https://github.com/subindev-d" identifier="https://orcid.org/0009-0001-1723-4394"/>
        <organization url="https://muon-spectroscopy-computational-project.github.io/index.html" name="The Muon Spectroscopy Computational Project"/>
    </creator>
    <requirements>
        <requirement type="package" version="1.0.1">mudirac</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    cat $input_yaml > input.in &&
    mudirac input.in
    ]]></command>
    <configfiles>
        <configfile name="input_yaml">element: $element
isotope: $isotope
xr_lines: $xr_lines
uehling_correction: $uehling_correction
nuclear_model: $nuclear_model
#if $electronic_config:
electronic_config: $electronic_config
#end if</configfile>
    </configfiles>
    <inputs>
        <param name="element" type="text" value="H" label="Element" help="Determines the nuclear charge. Can be any symbol in the periodic table up to Z=111, Roentgenium (Rg)" optional="false"/>
        <param name="isotope" type="integer" value="-1" label="which isotope of the element to consider" help=" Important to determine the mass of the nucleus and its size. Default is -1, 
        which means the most common isotope for the element will be used." optional="false"/>
        <param name="xr_lines" type="text" label="the transition or transitions for which energy and rates are desired" help=" Each line must be expressed using the conventional IUPAC notation [Jenkins et al., 1991]. 
        Multiple lines can be separated by commas. For example: K1-L2,K1-L3 . In addition, colons can be used to indicate ranges of lines. The notation K1:L3-M1 would compute the lines K1-M1, L1-M1, L2-M1 and L3-M1. 
        Note that if some of these lines are forbidden by selection rules, they will simply be skipped. A double colon, like K1:L3-K1:L3 would loop on both sides, and not count all repeated lines." optional="false">
            <validator type="empty_field" message="This input shoule not be empty"/>
        </param>
        <param name="nuclear_model" type="select" label="Model used to describe the nucleus">
            <option value="POINT"  selected="true"> point charge </option>
            <option value="SPHERE"> finite size, uniformly charged spherical nucleus </option>
            <option value="FERMI2"> Fermi 2-term charge distribution </option>
        </param>
        <param name="uehling_correction" type="boolean" value="false" label="Uehling correction" help="whether to turn on the Uehling correction or not" optional="true"/>
        <param name="electronic_config" type="text" value="" label="electronic configuration to use in order to describe the negative charge background" help="Can be a full string describing the configuration (e.g. 1s2 2s2 2p2), 
        an element symbol to represent the default configuration of that atom when neutral (e.g. C) or a mix of the two (e.g. [He] 2s2 2p2)" optional="true"/>
    </inputs>
    <outputs>
        <data name="output" format="txt" label="Output of ${tool.name}" from_work_dir="input.xr.out"/>
        <data name="log_out" label="log file of ${tool.name}" format="txt" from_work_dir="input.log"/>
    </outputs>
    <tests>
        <test>
            <param name="element" value="Au"/>
            <param name="isotope" value="197"/>
            <param name="xr_lines" value="K1-L2,K1-L3"/>
            <output name="output" file="Au_basic.xr.out" ftype="txt" compare="diff"/>
        </test>
        <test>
            <param name="element" value="Au"/>
            <param name="isotope" value="197"/>
            <param name="xr_lines" value="K1-L2,K1-L3"/>
            <param name="nuclear_model" value="FERMI2"/>
            <param name="uehling_correction" value="true"/>
            <param name="electronic_config" value="Au"/>
            <output name="output" file="Au.xr.out" ftype="txt" compare="diff"/>
        </test>
    </tests>
    <help><![CDATA[
    MuDirac is a simulation software that integrates the Dirac equation for muonic atoms to compute their X-Ray transition energies;
    Full documentation: https://muon-spectroscopy-computational-project.github.io/mudirac/
    ]]></help>
    <citations>
        <citation type="doi">https://doi.org/10.1002/xrs.3212</citation>
    </citations>
</tool>